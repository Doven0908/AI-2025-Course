<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prompt Strategy Playground</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="app-header">
    <h1>Prompt Strategy Playground</h1>
    <p class="tagline">MMLU-driven chat experiments with strategy-level telemetry</p>
  </header>

  <main class="app-shell">
    <section class="controls-panel" aria-label="controls">
      <div class="panel-block">
        <h2>API Settings</h2>
        <label class="field">
          <span>OpenAI API key</span>
          <input type="password" id="apiKeyInput" placeholder="sk-..." autocomplete="off">
        </label>
        <label class="field">
          <span>API Base URL</span>
          <input type="url" id="baseUrlInput" placeholder="https://.../v1" autocomplete="off" value="https://dashscope.aliyuncs.com/compatible-mode/v1">
        </label>
        <div class="field checkbox">
          <input type="checkbox" id="rememberKey">
          <label for="rememberKey">Remember in this browser</label>
        </div>
        <button id="toggleKeyVisibility" type="button">Show key</button>
      </div>

      <div class="panel-block">
        <h2>MMLU Prompt</h2>
        <div class="field">
          <span>Subject</span>
          <select id="subjectSelect"></select>
        </div>
        <div class="field">
          <span>Question</span>
          <select id="questionSelect"></select>
        </div>
        <button id="randomQuestion" type="button">Random question</button>
        <div class="field">
          <span>Prompt strategy</span>
          <select id="strategySelect">
            <option value="baseFewShot">Base + 2 shots</option>
            <option value="instruct">Instruct</option>
            <option value="cot">Chain of Thought</option>
            <option value="selfReflection">Self-reflection</option>
            <option value="cotVote">CoT + vote (N = 5)</option>
          </select>
        </div>
        <label class="field">
          <span>Model</span>
          <input id="modelInput" value="qwen-plus" autocomplete="off">
        </label>
        <label class="field">
          <span>Temperature</span>
          <input id="temperatureInput" type="number" min="0" max="2" value="0.3" step="0.1">
        </label>
        <label class="field">
          <span>Max tokens</span>
          <input id="maxTokensInput" type="number" min="1" value="1000">
        </label>
        <button id="runButton" type="button" class="primary">Run strategy</button>
      </div>

      <div class="panel-block">
        <h2>Baseline answer</h2>
        <pre id="referenceAnswer" class="reference"></pre>
      </div>

      <div class="panel-block">
        <h2>Experiment notes</h2>
        <textarea id="notesInput" placeholder="Add observations, next steps, etc."></textarea>
      </div>
    </section>

    <section class="results-panel" aria-label="results">
      <div class="metrics-card">
        <h2>Run Metrics</h2>
        <div class="metrics-grid" id="metricsGrid"></div>
      </div>

      <div class="log-card">
        <h2>Run Log</h2>
        <div id="logStream" class="log-stream" role="log" aria-live="polite"></div>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <span>Data source: MMLU subset | Calls proxied directly to selected API</span>
  </footer>

  <template id="logEntryTemplate">
    <article class="log-entry">
      <header>
        <h3 class="log-title"></h3>
        <span class="log-timestamp"></span>
      </header>
      <section class="log-body"></section>
      <footer class="log-metrics"></footer>
    </article>
  </template>

  <script type="module" src="main.js"></script>
</body>
</html>
